# Use an OpenJDK 17 base image
FROM eclipse-temurin:17-jdk

# Set the working directory inside the container
WORKDIR /app

# Download and install Apache Hop
RUN apt-get update && apt-get install -y wget unzip && \
    wget https://dlcdn.apache.org/hop/2.11.0/apache-hop-client-2.11.0.zip && \
    unzip apache-hop-client-2.11.0.zip -d /app/apache-hop && \
    rm apache-hop-client-2.11.0.zip

# Create required directories for Apache Hop configuration
RUN mkdir -p /app/hop-config /app/logs /app/workflows

# Set environment variables for Apache Hop
ENV HOP_HOME=/app/apache-hop
ENV HOP_CONFIG_FOLDER=/app/hop-config
ENV HOP_PASSWORD=mysecurepassword

# Expose a port for debugging if required
EXPOSE 8080

# Default command to run Apache Hop in CLI mode
CMD ["bash", "/app/apache-hop/hop/hop-run.sh"]
